<section class="card" style="background:#161a20;">
  <h2>Blackbox Analyzer</h2>
  <button onclick="runBlackbox('dht')">Generate DHT Chart</button>
  <button onclick="runBlackbox('mpu')">Generate MPU6050 Chart</button>
  <button onclick="runBlackbox('sound')">Generate Sound Chart</button>
  <pre id="blackbox_status"></pre>
</section>

<script>
async function runBlackbox(sensor) {
  document.getElementById("blackbox_status").textContent = "Running blackbox for " + sensor + "...";
  try {
    const res = await fetch("/blackbox/" + sensor);
    const data = await res.json();
    if (data.status === "ok") {
      document.getElementById("blackbox_status").textContent = "Chart generated: " + data.chart;
      if (sensor === "dht") refresh("dht_chart", data.chart);
      if (sensor === "mpu") refresh("mpu_chart", data.chart);
      if (sensor === "sound") refresh("sound_chart", data.chart);
    } else {
      document.getElementById("blackbox_status").textContent = "Error: " + data.message;
    }
  } catch (err) {
    document.getElementById("blackbox_status").textContent = "Failed: " + err;
  }
}
</script>
